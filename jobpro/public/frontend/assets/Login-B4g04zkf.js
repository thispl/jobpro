import{_ as k,o as p,u as L,b as I,a as f,q as i,c as n,e as t,w as b,h as g,j as c,k as r,s as P,g as h,t as x,F as y,r as F,n as v}from"./index-DyOgbLmy.js";const S={data(){return{email:"",password:"",loginFailed:!1,isLoggedIn:!1,loading:!1,showForgotPassword:!1,forgotEmail:"",error:"",success:!1,successfull:!1,errorField:"",otpLogin:!0,emailLogin:!1,forgotPassword:{email:"",full_name:""},otp:["","","","","",""],disabled:[!1,!1,!1,!1,!1,!1],disableVerify:!0,otpSent:"",otpEntered:"",otpMismatched:!1,redirecting:!1,loginBox:!0,show:!1}},mounted(){this.checkLoginStatus(),this.addIntersectionObserver(),window.gapi.load("auth2",()=>{window.gapi.auth2.getAuthInstance()||window.gapi.auth2.init({client_id:"YOUR_CLIENT_ID.apps.googleusercontent.com"})})},setup(){const o=p("state"),e=p("profileName"),u=p("profileMail"),d=p("candidateId"),s=L();return{state:o,profileName:e,profileMail:u,candidateId:d,handleLogout:()=>{o.isLoggedIn=!1,localStorage.removeItem("authToken"),localStorage.removeItem("fullName"),localStorage.removeItem("candidateToken"),s.push("/login"),window.location.reload()}}},methods:{onSignIn(o){const e=o.getBasicProfile();console.log("ID: "+e.getId()),console.log("Full Name: "+e.getName()),console.log("Given Name: "+e.getGivenName()),console.log("Family Name: "+e.getFamilyName()),console.log("Image URL: "+e.getImageUrl()),console.log("Email: "+e.getEmail());const u=o.getAuthResponse().id_token;console.log("ID Token: "+u)},checkLoginStatus(){const o=localStorage.getItem("authToken");this.loginFailed=!1,this.isLoggedIn=!!o},addIntersectionObserver(){const o=document.querySelectorAll(".fade-section"),e=new IntersectionObserver(u=>{u.forEach(d=>{this.onVisibilityChange(d.isIntersecting,d)})},{threshold:.1});o.forEach(u=>e.observe(u))},onVisibilityChange(o,e){o?e.target.classList.add("fade-in"):e.target.classList.remove("fade-in")},async handleLogin(){this.loading=!0;try{const o=await I.post("/api/method/login",{usr:this.email,pwd:this.password});console.log(o.data.message),o.status===200&&o.data.message?(localStorage.setItem("authToken",o.data.message),localStorage.setItem("fullName",o.data.full_name),localStorage.setItem("emailId",this.email),this.$router.push("/"),setTimeout(()=>{window.location.reload()},0)):this.loginFailed=!0}catch{this.loginFailed=!0}finally{this.loading=!1}},async submitForgotPassword(){this.loading=!0,this.error="",this.errorField="",this.success=!1;const{email:o}=this.forgotPassword,e=await f.changePassword(o);e&&(this.loading=!1,e.status==200&&e.statusText&&(this.success=!0)),e.statusText=="EXPECTATION FAILED"&&(this.error="user not found",this.loading=!1,this.errorField="mail",this.success=!1)},async handleOtpLogin(){this.loading=!0;const o=this.phone;try{const e=await await f.otpLogin(o);e.status==200&&e.data.message!="Failed to send OTP. Please try again."?(this.emailLogin=!1,this.otpLogin=!1,this.otpVerification=!0,this.otpSent=e.data.message,console.log(e.data.message)):(console.log("HIIII"),this.loginFailed=!0)}catch{this.loginFailed=!0}finally{this.loading=!1}},async resendOtp(){this.loading=!0;const o=this.phone;try{const e=await await f.otpLogin(o);e.status==200&&e.data.message!="Failed to send OTP. Please try again."?(this.otp=["","","","","",""],this.emailLogin=!1,this.otpLogin=!1,this.otpVerification=!0,this.otpSent=e.data.message):this.loginFailed=!0}catch{this.loginFailed=!0}finally{this.loading=!1}},handleOtp(o){const e=this.otp[o],u=e.match(/[0-9a-z]/gi);this.otp[o]=u?e[0]:"",u&&o<this.otp.length-1&&this.$nextTick(()=>{this.$refs[`otp-${o+1}`][0].focus()}),e===""&&o>0&&this.$nextTick(()=>{this.$refs[`otp-${o-1}`][0].focus()}),this.disableVerify=this.otp.some(d=>d==="")},async handleOtpVerification(){this.loading=!0;const o=this.otp.join("");this.otp.forEach((u,d)=>{this.disabled[d]=!1}),console.log(o);const e=await f.otpVerification(this.otpSent,o,this.phone);console.log(e.data.message),e.data.message=="invalid"&&(this.otpMismatched=!0,this.loading=!1),(e.data.message=="candidate not found"||e.data.message=="user not found")&&(console.log(e.data.message),this.loading=!1,this.redirecting=!0,this.loginBox=!1,setTimeout(()=>{this.$router.push({path:"/registration",query:{mobileMessage:this.phone}})},5e3)),e.data.message.message.includes("CD")&&(localStorage.setItem("candidateToken",e.data.message.message),localStorage.setItem("authToken",e.data.message.auth_token),localStorage.setItem("fullName",e.data.message.full_name),localStorage.setItem("emailId",e.data.message.user),this.candidateId=e.data.message.message,this.profileMail=e.data.message.user,this.loading=!1,this.redirecting=!0,this.loginBox=!1,this.$router.push("/"),setTimeout(()=>{window.location.reload()},0))},togglePassword(){this.show=!this.show}}},T={key:0,class:"mob-margin flex justify-center mt-20 fade-section"},C={key:0,class:"bg-white rounded-sm shadow-lg shadow-gray-600 w-[400px]"},V={class:"mx-10"},O={key:0},E={class:"relative"},N={key:1},M={class:"relative w-full"},z=["type"],D={key:0,class:"text-sm text-red-500 text-center font-semibold mt-4"},U={key:2},B={class:"text-sm text-[#7680a2] leading-5 mb-5"},q={class:"flex justify-center item-center font-sans"},j={class:"flex gap-4"},A=["onUpdate:modelValue","onInput","disabled"],R={key:0,class:"text-red-500 text-center text-sm font-medium my-3"},G=["disabled"],H={key:1,class:"text-center"},Y={class:"mt-20 text-[#05264e] text-2xl font-bold"},W={key:2,class:"text-center mt-[100px]"},X={key:3,class:"fixed inset-0 bg-black bg-opacity-[0.5] flex justify-center items-center"},J={class:"bg-white p-6 rounded-md border-0 shadow-xl w-[300px]"},K={key:0,class:"text-red-500 text-sm font-medium my-3"},Q={key:0,class:"text-center mt-4 absolute top-[40%] right-[50%]"},Z={key:1,class:"success-message absolute right-[50px] top-[90%]"},_={key:2,class:"text-center mt-[100px]"};function $(o,e,u,d,s,a){return i(),n(y,null,[t("div",{class:v([{"opacity-[0.5]":s.loading},""])},[!s.isLoggedIn&&!s.success?(i(),n("div",T,[s.loginBox?(i(),n("div",C,[t("div",V,[e[38]||(e[38]=t("h1",{class:"font-semibold text-xl mt-6",style:{color:"#05264e"}},"Login",-1)),s.otpLogin?(i(),n("div",O,[t("form",{class:"mt-10 mb-10",onSubmit:e[2]||(e[2]=b((...l)=>a.handleOtpLogin&&a.handleOtpLogin(...l),["prevent"]))},[t("div",E,[e[17]||(e[17]=t("label",{for:"otp",class:"text-md font-semibold",style:{color:"#05264e"}},"Mobile Number ",-1)),e[18]||(e[18]=t("br",null,null,-1)),g(t("input",{type:"tel","onUpdate:modelValue":e[0]||(e[0]=l=>o.phone=l),id:"phone",name:"phone",pattern:"[0-9]{10}",required:"",placeholder:"Enter your 10 digit mobile number",class:"border-gray-400 rounded-sm text-sm p-3 pl-10 mt-2 w-full mb-4",style:{color:"#7680a2"}},null,512),[[c,o.phone]]),e[19]||(e[19]=t("br",null,null,-1)),e[20]||(e[20]=t("p",{class:"absolute top-[40px] pl-2.5 mt-0.5 text-[#05264e] text-[15px] font-medium"},"+91",-1)),e[21]||(e[21]=t("p",{class:"text-sm text-[#7680a2]"},"You will receive an OTP on this number",-1)),e[22]||(e[22]=t("input",{type:"submit",class:"mt-10 text-white bg-blue-700 hover:bg-blue-800 focus:ring-1 font-medium rounded-sm text-sm px-4 py-2 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-400 w-full",style:{"font-size":"15px"},value:"Get OTP"},null,-1)),t("p",{onClick:e[1]||(e[1]=l=>(s.emailLogin=!0,s.otpLogin=!1)),class:"cursor-pointer mt-5 text-[#007be0] focus:ring-1 font-medium rounded-sm text-sm px-4 py-2.5 text-center border border-[#007be0] hover:scale-105 w-full transition-all"},"Use Email to Login")])],32)])):r("",!0),s.emailLogin?(i(),n("div",N,[t("form",{class:"mt-5 mb-10",onSubmit:e[9]||(e[9]=b((...l)=>a.handleLogin&&a.handleLogin(...l),["prevent"]))},[e[26]||(e[26]=t("label",{for:"email",class:"text-md font-semibold",style:{color:"#05264e"}},"Email ID ",-1)),e[27]||(e[27]=t("span",{class:"text-red-500"},"*",-1)),e[28]||(e[28]=t("br",null,null,-1)),g(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=l=>s.email=l),id:"email",name:"email",placeholder:"Enter Email ID",class:"border-gray-400 rounded-sm text-sm p-3 mt-2 w-full mb-4",style:{color:"#7680a2"},required:""},null,512),[[c,s.email]]),e[29]||(e[29]=t("br",null,null,-1)),e[30]||(e[30]=t("label",{for:"password",class:"text-md font-semibold",style:{color:"#05264e"}},"Password ",-1)),e[31]||(e[31]=t("span",{class:"text-red-500"},"*",-1)),e[32]||(e[32]=t("br",null,null,-1)),t("div",M,[g(t("input",{type:s.show?"text":"password","onUpdate:modelValue":e[4]||(e[4]=l=>s.password=l),id:"password",name:"password",placeholder:"Enter Password",class:"border-gray-400 border rounded-sm text-sm p-3 mt-2 w-full pr-14",style:{color:"#7680a2"},required:""},null,8,z),[[P,s.password]]),e[25]||(e[25]=t("br",null,null,-1)),s.show?r("",!0):(i(),n("svg",{key:0,onClick:e[5]||(e[5]=(...l)=>a.togglePassword&&a.togglePassword(...l)),class:"h-5 w-5 absolute right-5 top-5",fill:"#7680a2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512"},e[23]||(e[23]=[t("path",{d:"M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c8.4-19.3 10.6-41.4 4.8-63.3c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zM373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5L373 389.9z"},null,-1)]))),s.show?(i(),n("svg",{key:1,onClick:e[6]||(e[6]=(...l)=>a.togglePassword&&a.togglePassword(...l)),class:"h-5 w-5 absolute right-5 top-5",fill:"#7680a2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512"},e[24]||(e[24]=[t("path",{d:"M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"},null,-1)]))):r("",!0)]),t("p",{class:"text-xs text-blue-800 mt-2 text-right font-medium cursor-pointer",onClick:e[7]||(e[7]=l=>s.showForgotPassword=!0)},"Forgot Password?"),s.loginFailed?(i(),n("p",D,"Invalid login credentials")):r("",!0),e[33]||(e[33]=t("input",{type:"submit",class:"mt-4 text-white bg-blue-700 hover:bg-blue-800 focus:ring-1 font-medium rounded-sm text-sm px-4 py-2 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-400 w-full",style:{"font-size":"15px"},value:"Login"},null,-1)),t("p",{onClick:e[8]||(e[8]=l=>(s.otpLogin=!0,s.emailLogin=!1)),class:"text-[13px] text-center text-[#007be0] cursor-pointer mt-3 font-medium hover:scale-105 transition-all"},"Use OTP to Login")],32)])):r("",!0),o.otpVerification?(i(),n("div",U,[t("form",{class:"mt-5 mb-10",onSubmit:e[12]||(e[12]=b((...l)=>a.handleOtpVerification&&a.handleOtpVerification(...l),["prevent"]))},[t("p",B,[e[34]||(e[34]=h("We have sent a 6 digit OTP to your mobile")),e[35]||(e[35]=t("br",null,null,-1)),h(" number +91 "+x(this.phone),1)]),e[36]||(e[36]=t("label",{for:"email",class:"text-[15px] font-semibold",style:{color:"#05264e"}},"One Time Passcode ",-1)),e[37]||(e[37]=t("br",null,null,-1)),t("div",q,[t("div",j,[(i(!0),n(y,null,F(s.otp,(l,m)=>g((i(),n("input",{key:m,"onUpdate:modelValue":w=>s.otp[m]=w,placeholder:"*",maxlength:"1",onInput:w=>a.handleOtp(m),ref_for:!0,ref:`otp-${m}`,class:"w-10 h-10 rounded-sm mt-6 transition-all font-medium text-center text-[#007be0]",disabled:s.disabled[m]},null,40,A)),[[c,s.otp[m]]])),128))])]),t("p",{onClick:e[10]||(e[10]=l=>a.resendOtp()),class:"cursor-pointer mt-3 text-sm font-medium text-[#007be0]"},"Resend OTP"),s.otpMismatched?(i(),n("p",R,"Invalid OTP. Please enter a valid OTP")):r("",!0),t("input",{disabled:s.disableVerify,class:v([{"cursor-not-allowed":s.disableVerify,"mt-0":s.otpMismatched},"disabled:opacity-[0.5] mt-8 text-white bg-blue-700 hover:bg-blue-800 focus:ring-1 font-medium rounded-sm text-sm px-4 py-2 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-400 w-full"]),type:"submit",style:{"font-size":"15px"},value:"Verify & Login"},null,10,G),t("p",{onClick:e[11]||(e[11]=l=>(o.otpVerification=!1,s.otpLogin=!0,s.emailLogin=!1)),class:"cursor-pointer mt-5 text-[#007be0] focus:ring-1 font-medium rounded-sm text-sm px-4 py-2.5 text-center border border-[#007be0] hover:scale-105 w-full transition-all"},"Change Mobile Number")],32)])):r("",!0)])])):r("",!0)])):r("",!0),s.isLoggedIn?(i(),n("div",H,[t("h2",Y,[h("Hi "+x(d.profileName.fullName)+" "+x(d.profileMail.emailId)+"!",1),e[39]||(e[39]=t("br",null,null,-1)),e[40]||(e[40]=h(" Already, you have been logged in."))]),t("button",{onClick:e[13]||(e[13]=(...l)=>d.handleLogout&&d.handleLogout(...l)),class:"mx-auto mt-4 bg-red-500 text-white py-2 px-4 rounded"},"Logout")])):r("",!0),!s.isLoggedIn&&s.success?(i(),n("div",W,e[41]||(e[41]=[t("h1",{class:"text-xl font-semibold",style:{color:"#05264e"}},"Password Email Sent",-1),t("p",{class:"text-md mt-3 font-medium",style:{color:"#05264e"}},"Password reset instructions have been sent to your email",-1)]))):r("",!0),s.showForgotPassword&&!s.success?(i(),n("div",X,[t("div",J,[e[46]||(e[46]=t("h2",{class:"text-md font-semibold",style:{color:"#05264e"}},"Forgot Password",-1)),t("form",{onSubmit:e[15]||(e[15]=b((...l)=>a.submitForgotPassword&&a.submitForgotPassword(...l),["prevent"])),id:"forgotPassword",class:"mt-3"},[e[42]||(e[42]=t("label",{for:"email",class:"text-sm font-semibold",style:{color:"#05264e"}},"Email ID ",-1)),e[43]||(e[43]=t("span",{class:"text-red-500"},null,-1)),e[44]||(e[44]=t("br",null,null,-1)),g(t("input",{type:"email","onUpdate:modelValue":e[14]||(e[14]=l=>s.forgotPassword.email=l),placeholder:"Enter your email",class:"mb-1 border-gray-400 rounded-sm text-sm p-3 w-full mt-1",style:{color:"#7680a2"},required:""},null,512),[[c,s.forgotPassword.email]]),s.errorField=="mail"?(i(),n("p",K,x(s.error),1)):r("",!0),e[45]||(e[45]=t("button",{type:"submit",class:"mt-5 text-white bg-blue-700 hover:bg-blue-800 focus:ring-1 font-medium rounded-sm text-sm px-4 py-2 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-400 w-full",style:{"font-size":"15px"}},"Confirm",-1))],32),t("button",{onClick:e[16]||(e[16]=l=>s.showForgotPassword=!1),class:"text-[13px] text-center text-blue-800 mt-2 font-medium"},"Cancel")])])):r("",!0)],2),s.loading?(i(),n("div",Q,e[47]||(e[47]=[t("p",null,[t("span",{class:"loader"})],-1)]))):r("",!0),s.successfull?(i(),n("div",Z,e[48]||(e[48]=[t("div",{class:"bg-gradient-to-r from-[#0bda51] to-[#0bda51] rounded-sm shadow-xl h-10 pt-2 w-[250px]"},[t("p",{class:"text-white font-semibold font-sans text-center"},"Password Updated Successfully")],-1)]))):r("",!0),e[50]||(e[50]=t("div",{class:"g_id_signin","data-onsuccess":"onSignIn"},null,-1)),s.redirecting?(i(),n("div",_,e[49]||(e[49]=[t("h1",{class:"text-xl font-semibold",style:{color:"#05264e"}},"The mobile number is not registered",-1),t("p",{class:"text-md mt-3 font-medium",style:{color:"#05264e"}},"redirecting to registration...",-1)]))):r("",!0)],64)}const te=k(S,[["render",$]]);export{te as default};
